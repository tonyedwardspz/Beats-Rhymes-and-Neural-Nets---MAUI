<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="MAUI_App.Views.LLMPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:converters="clr-namespace:MAUI_App.Converters"
             Title="LLM Chat">
    
    <ContentPage.Resources>
        <ResourceDictionary>
            <converters:InvertedBoolConverter x:Key="InvertedBoolConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid Margin="20" ColumnSpacing="20" RowSpacing="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="2*" />
        </Grid.ColumnDefinitions>
        
        <!-- Left Column: Controls -->
        <Grid Grid.Column="0" VerticalOptions="FillAndExpand">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <!-- Input Section -->
            <Frame Grid.Row="0" 
                   BackgroundColor="#2D2D30" 
                   Padding="15" 
                   CornerRadius="8"
                   VerticalOptions="FillAndExpand">
                <VerticalStackLayout Spacing="10" VerticalOptions="Fill">
                    <Label Text="Enter your prompt:" 
                           FontSize="18" 
                           FontAttributes="Bold" 
                           TextColor="White" 
                           />
                    
                    <Editor Text="{Binding Prompt}" 
                            Placeholder="Type your prompt here..."
                            PlaceholderColor="Gray"
                            TextColor="White"
                            BackgroundColor="#1E1E1E"
                            VerticalOptions="Fill"
                            HeightRequest="325"
                            IsEnabled="{Binding IsGenerating, Converter={StaticResource InvertedBoolConverter}}" />
                    
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                        <Button Grid.Column="0"
                                Text="Generate Response" 
                                Command="{Binding GenerateCommand}"
                                BackgroundColor="Green"
                                TextColor="White"
                                CornerRadius="6"
                                IsEnabled="{Binding IsGenerating, Converter={StaticResource InvertedBoolConverter}}" />
                        
                        <Button Grid.Column="1"
                                Text="Stream Response" 
                                Command="{Binding GenerateStreamingCommand}"
                                BackgroundColor="Blue"
                                TextColor="White"
                                CornerRadius="6"
                                IsEnabled="{Binding IsGenerating, Converter={StaticResource InvertedBoolConverter}}" />
                    </Grid>
                </VerticalStackLayout>
            </Frame>
            
            <!-- Model Status Section -->
            <Frame Grid.Row="1" 
                   BackgroundColor="#2D2D30" 
                   Padding="15" 
                   CornerRadius="8"
                   Margin="0,0,0,15">
                <VerticalStackLayout Spacing="10">
                    <Label Text="ðŸ¤– LLM Model Information" 
                           FontSize="18" 
                           FontAttributes="Bold" 
                           HorizontalOptions="Center"
                           TextColor="White" />
                    
                    <ScrollView HeightRequest="200">
                        <Label Text="{Binding ModelInfo}" 
                               FontFamily="Courier"
                               LineBreakMode="WordWrap"
                               TextColor="LightGray" />
                    </ScrollView>
                    
                    <Label Text="{Binding StatusMessage}" 
                           FontAttributes="Bold" 
                           TextColor="White" />
                    
                    <Button Text="Refresh Model Info" 
                            Command="{Binding CheckModelInfoCommand}"
                            BackgroundColor="#0078D4" 
                            TextColor="White"
                            CornerRadius="6" />
                </VerticalStackLayout>
            </Frame>
        </Grid>
        
        <!-- Right Column: Results -->
        <Grid Grid.Column="1" VerticalOptions="FillAndExpand">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            
            <Label Text="Transcription Results" 
                   Grid.Row="0"
                   FontSize="18" 
                   FontAttributes="Bold" 
                   TextColor="White"
                   Margin="0,0,0,10" />
            
            <ScrollView Grid.Row="1" 
                       VerticalOptions="FillAndExpand"
                       BackgroundColor="LightGray">
                <Label Text="{Binding Response}" 
                       FontSize="16"
                       TextColor="Black"
                       BackgroundColor="LightGray"
                       Padding="15"
                       VerticalOptions="FillAndExpand"
                       LineBreakMode="WordWrap" />
            </ScrollView>
        </Grid>
    </Grid>

</ContentPage>
